/**********************************************************************************************************************
 * @file        sound_sensor.h
 * @brief       Driver for sound sensor
 * @version     1.0
 * @date        2025-01-19
 *  *********************************************************************************************************************/

#ifndef INC_SENSORS_SOUND_SENSOR_H_
#define INC_SENSORS_SOUND_SENSOR_H_

/*********************************************************************************************************************/
/*-----------------------------------------------------Includes------------------------------------------------------*/
#include "Ifx_Types.h"
#include "IfxVadc.h"
#include "IfxVadc_Adc.h"
#include "math.h"

#include "Bsp.h"
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*------------------------------------------------------Macros-------------------------------------------------------*/
#define MIN_DB              40.0f
#define MAX_DB              120.0f

#define DB_OFFSET           40.0f

//조용한 상황(40dB)에서 아날로그 850 값에 대한 기준 전압
#define BASE_VOLTAGE        1.037f
#define REFERENCE_VOLTAGE   0.01037f
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*-------------------------------------------------Global variables--------------------------------------------------*/
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*-------------------------------------------------Data Structures---------------------------------------------------*/
typedef struct
{
    IfxVadc_Adc vadc; /* VADC handle */
    IfxVadc_Adc_Group adcGroup;
} SoundSensorVadcAutoScan;

IFX_EXTERN SoundSensorVadcAutoScan g_sound_sensor_scan;
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*--------------------------------------------Private Variables/Constants--------------------------------------------*/
/*********************************************************************************************************************/


/*********************************************************************************************************************/
/*------------------------------------------------Function Prototypes------------------------------------------------*/
extern void init_sound_sensor(void);
void start_sound_sensor_conversion(void);
uint32 obtain_sound_sensor_data(void);
extern uint32 get_sound_sensor_analog_value(void);
float convert_to_decibel(uint32 analogValue);
extern uint8 get_decibel(void);
/*********************************************************************************************************************/


#endif /* INC_SENSORS_SOUND_SENSOR_H_ */
